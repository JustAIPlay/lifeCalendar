<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生命日历</title>
    
    <!-- 模块化CSS -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/calendar.css">
    <link rel="stylesheet" href="css/ui.css">
    <link rel="stylesheet" href="css/card.css">
    <link rel="stylesheet" href="css/modal.css">
</head>
<body>
    <div class="input-container">
        <div class="theme-selector">
            <!-- 主题选择器将由ThemeManager动态生成 -->
        </div>
        <input type="date" id="birthDate" placeholder="选择出生日期">
    </div>
    
    <div class="calendar-container" id="calendar"></div>
    
    <div class="info">
        <div>已度过 0 周，剩余 4680 周</div>
        <div>当前年龄：0 岁</div>
        <div>生命进度：0%</div>
    </div>
    
    <div class="legend">
        <div class="legend-item">
            <div class="legend-color" style="background-color: var(--past);"></div>
            <span>已度过</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background-color: var(--now);"></div>
            <span>现在</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background-color: var(--future);"></div>
            <span>未来</span>
        </div>
    </div>
    
    <div class="card-generator">
        <button class="generate-btn">
            🎨 生成生命卡片
        </button>
    </div>

    <!-- 卡片生成模态框 -->
    <div class="card-modal" id="cardModal">
        <div class="card-content">
            <h2>生成你的生命卡片</h2>
            <div class="card-preview" id="cardPreview">
                <!-- SVG卡片将在这里显示 -->
            </div>
            
            <div class="download-section">
                <button class="download-btn">📥 下载PNG图片</button>
                <button class="close-btn">关闭</button>
            </div>
        </div>
    </div>

    <!-- 模块化JavaScript -->
    <script src="js/core/date-utils.js"></script>
    <script src="js/core/calendar.js"></script>
    <script src="js/theme/themes.js"></script>
    <script src="js/theme/theme-manager.js"></script>
    <script src="js/card/quotes.js"></script>
    <script src="js/card/card-generator.js"></script>
    <script src="js/ui/modal.js"></script>
    <script src="js/ui/event-handlers.js"></script>
    
    <script>
        // 应用初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化所有模块
            Calendar.init();
            ThemeManager.init();
            CardGenerator.init();
            Modal.init();
            EventHandlers.init();
            
            // 监听主题变化
            ThemeManager.onThemeChange(EventHandlers.handleThemeChange);
            
            // 监听模态框事件
            document.addEventListener('modalOpen', function() {
                // 模态框打开时的处理
                const birthDate = new Date(document.getElementById('birthDate').value);
                if (!isNaN(birthDate.getTime())) {
                    Modal.updateCardPreview(birthDate);
                }
            });
            
            console.log('生命日历模块化版本初始化完成');
        });
    </script>
</body>
</html>